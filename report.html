<!-- Prepared by: Eng. Aisha Alhuwais | ID: 22101186 -->
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ุฌุฏูู ุงููุงุนุงุช ุงูุฏุฑุงุณูุฉ</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <style>
    
    .filter-btn {
      background: #e5ebf1;
      color: #0e223a;
      border: none;
      border-radius: 14px;
      padding: 12px 26px;
      font-family: 'Cairo', Tahoma, Arial, sans-serif;
      font-weight: bold;
      font-size: 1.05em;
      transition: 0.13s;
      cursor: pointer;
    }
    .filter-btn.active, .filter-btn:focus {
      background: #002147 !important;
      color: #fff !important;
    }
    .lock-btn {
      background: #dde4ea;
      color: #2c333a;
      border: none;
      border-radius: 12px;
      padding: 7px 18px 7px 14px;
      font-family: 'Cairo', Tahoma, Arial, sans-serif;
      font-weight: bold;
      font-size: 1.01em;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .add-btn[disabled] {
      background: #b3bac2 !important;
      color: #fff !important;
      cursor: not-allowed !important;
      opacity: 0.65;
    }
    body { font-family: 'Cairo', Tahoma, Arial, sans-serif; background: #f7fafc; margin: 0; padding: 40px;}
    .container { max-width: 1100px; margin: auto; background: #fff; border-radius: 16px; box-shadow: 0 2px 16px #0001; padding: 28px;}
    h1 { color: #002147; margin-bottom: 24px;}
   
    .add-btn { background: #002147; color: #fff; border: none; border-radius: 8px; padding: 7px 22px; font-family: 'Cairo', Tahoma, Arial, sans-serif; font-weight: bold; font-size: 1.1em; margin-bottom: 18px; cursor: pointer;}
    .table-responsive { overflow-x: auto; margin-top: 16px;}
    table { border-collapse: collapse; width: 100%; min-width: 950px;}
    th, td { border: 1px solid #dbeafe; padding: 7px 10px; text-align: center;}
    th { background: #002147; color: #fff;}
    tr:nth-child(even) td { background: #f3f6fa; }
    .top-controls {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
      flex-wrap: wrap;
      gap: 12px;
    }
    .filter-group {
      display: flex;
      gap: 12px;
      margin-left: auto;
    }
    .search-group {
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: center;
      flex: 1;
    }
    .search-input {
      font-family:'Cairo';
      padding: 9px 16px;
      border-radius: 10px;
      border: 1px solid #d3dce6;
      min-width: 260px;
      font-size: 1.15em;
      text-align: center;
      box-shadow: 0 2px 6px #0001;
    }
    @media (max-width: 700px) {
      .top-controls { flex-direction: column; gap: 7px; }
      .search-group { justify-content: flex-start; }
      .filter-group { margin-left: 0; justify-content: flex-end; }
      .search-input { min-width: 120px; }
    }
  </style>
  
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
</head>
<body>
<div class="container">

  <!-- ุฒุฑ ุงูููู-->
<div style="display: flex; align-items: center; justify-content: center; gap: 7px; margin-bottom: 16px;">
    <h1 style="margin:0;font-size:2.1em;color:#14223A;font-weight:900;letter-spacing:1px;">ุฌุฏูู ุงููุงุนุงุช ุงูุฏุฑุงุณูุฉ</h1>
</div>
  <!-- ุงูุจุญุซ  -->
  <div class="search-group" style="display:flex;flex-direction:column;align-items:center;margin-bottom:18px;">
    <label style="font-size:1.1em;font-weight:600;margin-bottom:7px;"></label>
    <input type="text" id="searchInput" class="search-input" placeholder="ุฃุฏุฎู ุฑูู ุงููุงุนุฉ" oninput="renderTable()"/>
  </div>
  
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;gap:12px;">
  <div class="filter-group" style="display:flex; gap:12px;">
    <button id="allBtn" onclick="filterByBuilding('all')" class="filter-btn">โ</button>
    <button id="northBtn" onclick="filterByBuilding('ุงูุดูุงูู')" class="filter-btn active">ุงููุจูู ุงูุดูุงูู</button>
    <button id="southBtn" onclick="filterByBuilding('ุงูุฌููุจู')" class="filter-btn">ุงููุจูู ุงูุฌููุจู</button>
  </div>

     </div>

 <div class="table-responsive" style="overflow-x:auto; width:100%;">
      <table>
        <thead>
          <tr>
            <th>ุงูุญุงูุฉ</th>
            <th>ุงููุจูู</th>
            <th>ุงูุฏูุฑ</th>
            <th>ููุน ุงููุงุนุฉ</th>
            <th>ุฑูู ุงููุงุนุฉ</th>
            <th>ุงูุณุนุฉ</th>
            <th>ุจูุฏููู</th>
            <th>ุงูููุจููุชุฑ</th>
            <th>ุงูุดุจูุฉ</th>
            <th>ุฌูุงุฒ ุงูุนุฑุถ</th>
            <th>ุฌูุงุฒ ุงูุนุฑุถ</th>
            <th>ุงููููุฑูููู</th>
            <th>ุงูุฅุถุงุกุฉ </th>
            <th>ุงูุณุชุงุฆุฑ</th>
            <th>ููุงุญุธุงุช</th>
          </tr>
        </thead>
        <tbody id="tableBody"></tbody>
      </table>
    </div>
  
  </div>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDqMFfWwtzXInusoxsJxgEO5_ptz_fRk6E",
  authDomain: "itu-coa.firebaseapp.com",
  projectId: "itu-coa",
  storageBucket: "itu-coa.firebasestorage.app",
  messagingSenderId: "790497191019",
  appId: "1:790497191019:web:a5b4de6f65574457503d2e",
  measurementId: "G-D5L66D3QZP"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const collectionName = "classes";
let currentUser = localStorage.getItem("currentUser") || "";
let allClasses = [];
let currentBuildingFilter = "ุงูุดูุงูู"; 
let isLocked = true;
  
const userMap = {
  "ุงูุดูุงูู-G": "mohan",
  "ุงูุดูุงูู-1": "noriya",
  "ุงูุดูุงูู-2": "noriya",
  "ุงูุดูุงูู-3": "mohan",
  "ุงูุดูุงูู-4": "mohan",
  "ุงูุฌููุจู-G": "mohammed",
  "ุงูุฌููุจู-1": "maryam",
  "ุงูุฌููุจู-2": "ganima",
  "ุงูุฌููุจู-3": "shikha",
  "ุงูุฌููุจู-4": "dalal"
};

// ุชุญููู ุงูุจูุงูุงุช
function loadTable() {
  db.collection(collectionName).onSnapshot(snapshot => {
    allClasses = [];
snapshot.forEach(doc => {
  let data = doc.data();
  data.id = doc.id;   
  allClasses.push(data);
});

    renderTable();
  });
}

  function getAllowedRolesForUser(username) {
  return Object.entries(userMap)
    .filter(([key, value]) => value === username)
    .map(([key, value]) => key);
}
function renderTable() {
  const tbody = document.getElementById('tableBody');
  const searchTerm = document.getElementById('searchInput').value.trim();
  let filtered = allClasses;

  if (searchTerm) {
    filtered = filtered.filter(d =>
      (d.no && d.no.toString().includes(searchTerm)) ||
      (d.type && d.type.includes(searchTerm)) ||
      (d.remark && d.remark.includes(searchTerm))
    );
  } else if (currentBuildingFilter !== "all") {
    filtered = filtered.filter(d => (d.building || "").trim() === currentBuildingFilter);
  }

 tbody.innerHTML = "";
  if (filtered.length === 0) {
    tbody.innerHTML = "<tr><td colspan='15'>ูุง ุชูุฌุฏ ุจูุงูุงุช</td></tr>";
    return;
  }
filtered.forEach((d, idx) => {
 const isAdmin = currentUser === "admin";
const allowedRoles = getAllowedRolesForUser(currentUser);
const canEdit = isAdmin || allowedRoles.includes(`${d.building}-${d.floor}`);
const editBtn = canEdit ? `<button onclick="editClass('${d.id}')">โ๏ธ</button>` : '';
    const row = `<tr>
      <td>${d.status || ""}</td>
      <td>${d.building || ""}</td>
      <td>${d.floor || ""}</td>
      <td>${d.type || ""}</td>
      <td>${d.no || ""}</td>
      <td>${d.cap || ""}</td>
      <td>${d.podium || ""}</td>
      <td>${d.pc || ""}</td>
      <td>${d.network || ""}</td>
      <td>${d.proj1 || ""}</td>
      <td>${d.proj2 || ""}</td>
      <td>${d.mic || ""}</td>
      <td>${d.light || ""}</td>
      <td>${d.curtain || ""}</td>
      <td>${d.remark || ""}</td>
      <td>${editBtn}</td>
    </tr>`;
    tbody.innerHTML += row;
  });
}

  function showLogin() {
  Swal.fire({
    title: 'ุชุณุฌูู ุฏุฎูู ุงููุฑูู',
    html: `<input id="swal-username" class="swal2-input" placeholder="ุงุณู ุงููุณุชุฎุฏู">
           <input id="swal-password" type="password" class="swal2-input" placeholder="ูููุฉ ุงููุฑูุฑ">`,
    confirmButtonText: 'ุฏุฎูู',
    showCancelButton: true,
    preConfirm: async () => {
      const username = document.getElementById('swal-username').value;
      const password = document.getElementById('swal-password').value;
      if (!username || !password) {
        Swal.showValidationMessage('ุฃุฏุฎู ุฌููุน ุงูุจูุงูุงุช');
        return false;
      }
      const querySnapshot = await db.collection("it_team")
        .where("username", "==", username)
        .where("password", "==", password)
        .get();
      if (!querySnapshot.empty) {
        currentUser = username;
        localStorage.setItem("currentUser", username); // ุญูุธ ูู localStorage
        return true;
      } else {
        Swal.showValidationMessage('ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ');
        return false;
      }
    }
  }).then((result) => {
    if (result.isConfirmed) {
      Swal.fire({
        title: 'ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ!',
        icon: 'success'
      });
    }
  });
}
  function filterByBuilding(building) {
  currentBuildingFilter = building;
  document.getElementById("northBtn").classList.remove("active");
  document.getElementById("southBtn").classList.remove("active");
  document.getElementById("allBtn").classList.remove("active");
  if (building === "ุงูุดูุงูู") document.getElementById("northBtn").classList.add("active");
  else if (building === "ุงูุฌููุจู") document.getElementById("southBtn").classList.add("active");
  else document.getElementById("allBtn").classList.add("active");
  renderTable();
}

function toggleLock() {
  if (!isLocked) {
    isLocked = true;
    document.getElementById("addClassBtn").setAttribute("disabled", "true");
    document.getElementById("lockIcon").textContent = "๐";
  } else {
    Swal.fire({
      title: 'ุชุณุฌูู ุงูุฏุฎูู (Admin)',
      html: `<input id="swal-username" class="swal2-input" placeholder="ุงุณู ุงููุณุชุฎุฏู">
             <input id="swal-password" type="password" class="swal2-input" placeholder="ูููุฉ ุงููุฑูุฑ">`,
      confirmButtonText: 'ุฏุฎูู',
      showCancelButton: true,
      preConfirm: () => {
        const username = document.getElementById('swal-username').value;
        const password = document.getElementById('swal-password').value;
        if (!username || !password) {
          Swal.showValidationMessage('ุฃุฏุฎู ุงูุจูุงูุงุช');
          return false;
        }
        return { username, password };
      }
    }).then(async (result) => {
      if (result.isConfirmed && result.value) {
        const q = await db.collection("admin_users")
          .where("username", "==", result.value.username)
          .where("password", "==", result.value.password)
          .get();
        if (!q.empty) {
          isLocked = false;
          document.getElementById("addClassBtn").removeAttribute("disabled");
          document.getElementById("lockIcon").textContent = "๐";
          Swal.fire('ุชู ูุชุญ ุงูููู!', '', 'success');
        } else {
          Swal.fire('ุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ', 'ุชุญูู ูู ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ', 'error');
        }
      }
    });
  }
}

function addClassFlow() {
  openAddSwal();
}

  function openAddSwal() {
  Swal.fire({
    title: `<div style="font-weight:900; font-size:1.3em; color:#1a3765; margin-bottom:5px; letter-spacing:1px;">โ ุฅุถุงูุฉ ูุงุนุฉ ุฏุฑุงุณูุฉ</div>`,
    width: 900,
    customClass: {
      popup: 'swal-wide-modal'
    },
    html:
      `<div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
        <div>
          <label style="font-weight:700;">ุงูุญุงูุฉ</label>
          <select id="swal-status" class="swal2-input" style="width:100%;">
            <option>๐ข</option>
            <option>๐ด</option>
            <option>๐ก</option>
          </select>
        </div>
        <div>
          <label style="font-weight:700;">ุงููุจูู</label>
          <select id="swal-building" class="swal2-input" style="width:100%;">
            <option>ุงูุดูุงูู</option>
            <option>ุงูุฌููุจู</option>
          </select>
        </div>
        <div>
          <label style="font-weight:700;">ุงูุฏูุฑ</label>
          <select id="swal-floor" class="swal2-input" style="width:100%;">
            <option>G</option>
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
          </select>
        </div>
        <div>
          <label style="font-weight:700;">ููุน ุงููุงุนุฉ</label>
          <select id="swal-type" class="swal2-input" style="width:100%;">
            <option>ูุตู ุฏุฑุงุณู</option>
            <option>ุบุฑูุฉ ุชุฏุฑูุจ</option>
            <option>ุบุฑูุฉ ุฅุฌุชูุงุนุงุช</option>
            <option>ูุงุนุฉ ุนุฑุถ</option>
            <option>ูุฎุชุจุฑ ุงููุบุงุช</option>
            <option>ูุฎุชุจุฑ ุงูุญุงุณูุจ</option>
            <option>ุชุฏุฑูุจ ูุณุฑุญู</option>
            <option>ูุฎุชุจุฑ ุงูุชุตููุฑ ุงูุตุญูู</option>
            <option>ูุฎุชุจุฑ ุงูุชุญุฑูุฑ</option>
            <option>ุฅูุชุงุฌ ุงูุตุญู</option>
            <option>ูุฎุชุจุฑ ูุณุงุฆู ุงูุฅุนูุงู ุงูุฑูููุฉ</option>
            <option>ูุฎุชุจุฑ ุงูุฏุนุงูุฉ ูุงูุฅุนูุงู</option>
            <option>ูุฎุชุจุฑ ุงููุณุงุฆุท ุงููุชุนุฏุฏุฉ</option>
            <option>ุงูุฅุฎุฑุงุฌ ุงูุฅุฐุงุนู</option>
            <option>ุงููุณุฑุญ ุงูุฃุณูุฏ</option>
          </select>
        </div>
        <div>
          <label style="font-weight:700;">ุฑูู ุงููุงุนุฉ</label>
          <input id="swal-no" class="swal2-input" placeholder="ุฑูู ุงููุงุนุฉ" required>
        </div>
        <div>
          <label style="font-weight:700;">ุงูุณุนุฉ</label>
          <input id="swal-cap" class="swal2-input" placeholder="ุนุฏุฏ ุงูููุงุนุฏ" required>
        </div>
        <div>
          <label style="font-weight:700;">ุจูุฏููู</label>
          <select id="swal-podium" class="swal2-input" style="width:100%;">
            <option>ุดุบุงู</option>
            <option>ููุฏ ุงูุตูุงูุฉ</option>
            <option>ุบูุฑ ุดุบุงู</option>
            <option>-</option>
          </select>
        </div>
        <div>
          <label style="font-weight:700;">ุงูููุจููุชุฑ</label>
          <select id="swal-pc" class="swal2-input" style="width:100%;">
            <option>ุดุบุงู</option>
            <option>ููุฏ ุงูุตูุงูุฉ</option>
            <option>ุบูุฑ ุดุบุงู</option>
            <option>-</option>
          </select>
        </div>
        <div>
          <label style="font-weight:700;">ุงูุดุจูุฉ</label>
          <select id="swal-network" class="swal2-input" style="width:100%;">
            <option>ูุชุตู</option>
            <option>ุบูุฑ ูุชุตู</option>
            <option>-</option>
          </select>
        </div>
        <div>
          <label style="font-weight:700;">ุฌูุงุฒ ุงูุนุฑุถ</label>
          <select id="swal-proj1" class="swal2-input" style="width:100%;">
            <option>ุดุบุงู</option>
            <option>ููุฏ ุงูุตูุงูุฉ</option>
            <option>ุบูุฑ ุดุบุงู</option>
            <option>-</option>
          </select>
        </div>
        <div>
          <label style="font-weight:700;">ุฌูุงุฒ ุงูุนุฑุถ</label>
          <select id="swal-proj2" class="swal2-input" style="width:100%;">
            <option>ุดุบุงู</option>
            <option>ููุฏ ุงูุตูุงูุฉ</option>
            <option>ุบูุฑ ุดุบุงู</option>
            <option>-</option>
          </select>
        </div>
        <div>
          <label style="font-weight:700;">ุงููููุฑูููู</label>
          <select id="swal-mic" class="swal2-input" style="width:100%;">
            <option>ุดุบุงู</option>
            <option>ููุฏ ุงูุตูุงูุฉ</option>
            <option>ุบูุฑ ุดุบุงู</option>
            <option>-</option>
          </select>
        </div>
        <div>
          <label style="font-weight:700;">ุงูุฅุถุงุกุฉ</label>
          <select id="swal-light" class="swal2-input" style="width:100%;">
            <option>ุดุบุงู</option>
            <option>ููุฏ ุงูุตูุงูุฉ</option>
            <option>ุบูุฑ ุดุบุงู</option>
            <option>-</option>
          </select>
        </div>
        <div>
          <label style="font-weight:700;">ุงูุณุชุงุฆุฑ</label>
          <select id="swal-curtain" class="swal2-input" style="width:100%;">
            <option>ุดุบุงู</option>
            <option>ููุฏ ุงูุตูุงูุฉ</option>
            <option>ุบูุฑ ุดุบุงู</option>
            <option>-</option>
          </select>
        </div>
        <div style="grid-column:1/-1;">
          <label style="font-weight:700;">ููุงุญุธุงุช</label>
          <textarea id="swal-remark" class="swal2-textarea" 
            placeholder="ุงูุชุจ ุฃู ููุงุญุธุฉ ููุง"
            style="width:80%;min-height:34px;max-height:100px;resize:vertical;text-align:right;"></textarea>
        </div>
      </div>`,
    confirmButtonText: 'ุฅุถุงูุฉ',
    showCancelButton: true,
    cancelButtonText: "ุฅูุบุงุก",
    preConfirm: () => {
      const get = id => document.getElementById(id).value;
      if (!get('swal-no') || !get('swal-cap')) {
        Swal.showValidationMessage('ูุฌุจ ุฅุฏุฎุงู ุฑูู ุงููุงุนุฉ ูุงูุณุนุฉ');
        return false;
      }
      return {
        status: get('swal-status'),
        building: get('swal-building'),
        floor: get('swal-floor'),
        type: get('swal-type'),
        no: get('swal-no'),
        cap: get('swal-cap'),
        podium: get('swal-podium'),
        pc: get('swal-pc'),
        network: get('swal-network'),
        proj1: get('swal-proj1'),
        proj2: get('swal-proj2'),
        mic: get('swal-mic'),
        light: get('swal-light'),
        curtain: get('swal-curtain'),
        remark: get('swal-remark')
      };
    }
  }).then((result) => {
    if (result.isConfirmed && result.value) {
      db.collection("classes").add({
        ...result.value,
        last_edited_by: currentUser || "ุบูุฑ ูุนุฑูู",
        last_edited_at: new Date().toISOString()
      })
      .then(() => {
        Swal.fire('ุชูุช ุงูุฅุถุงูุฉ!', 'ุชู ุฅุถุงูุฉ ุงููุตู ุจูุฌุงุญ', 'success');
        loadTable();
      })
      .catch(() => {
        Swal.fire('ุฎุทุฃ', 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุฅุถุงูุฉ!', 'error');
      });
    }
  });
}

  function editClass(id) {
  const docData = allClasses.find(x => x.id === id);
  if (!docData) return;

  Swal.fire({
    title: `<div style="font-weight:900; font-size:1.35em; color:#1a3765; margin-bottom:5px; letter-spacing:1px;">ุชุนุฏูู ุจูุงูุงุช ุงููุงุนุฉ</div>
    <div style="font-size:1em; color:#495968; margin-bottom:6px;">ูุฑุฌู ุชุนุฏูู ุงูุจูุงูุงุช ุซู ุงูุถุบุท ุนูู "ุญูุธ ุงูุชุนุฏูู"</div>`,
    width: 920,
    padding: '0 0 20px 0',
    background: '#fff',
    showCloseButton: true,
    showCancelButton: true,
    confirmButtonText: 'ุญูุธ ุงูุชุนุฏูู',
    cancelButtonText: 'ุฅูุบุงุก',
    customClass: {
      popup: 'swal-wide-modal',
      confirmButton: 'swal2-confirm-btn',
      cancelButton: 'swal2-cancel-btn'
    },
    html: `
    <div dir="rtl" style="display:grid;grid-template-columns:1fr 1fr;gap:17px;padding:8px 0 0 0;">
      <div>
        <label style="font-weight:700;">ุงูุญุงูุฉ</label>
        <select id="swal-status-edit" class="swal2-input" style="width:100%;">
          <option ${docData.status === "๐ข" ? "selected" : ""}>๐ข</option>
          <option ${docData.status === "๐ด" ? "selected" : ""}>๐ด</option>
          <option ${docData.status === "๐ก" ? "selected" : ""}>๐ก</option>
        </select>
      </div>
      <div>
        <label style="font-weight:700;">ุงููุจูู</label>
        <select id="swal-building-edit" class="swal2-input" style="width:100%;">
          <option ${docData.building === "ุงูุดูุงูู" ? "selected" : ""}>ุงูุดูุงูู</option>
          <option ${docData.building === "ุงูุฌููุจู" ? "selected" : ""}>ุงูุฌููุจู</option>
        </select>
      </div>
      <div>
        <label style="font-weight:700;">ุงูุฏูุฑ</label>
        <select id="swal-floor-edit" class="swal2-input" style="width:100%;">
          <option ${docData.floor === "G" ? "selected" : ""}>G</option>
          <option ${docData.floor === "1" ? "selected" : ""}>1</option>
          <option ${docData.floor === "2" ? "selected" : ""}>2</option>
          <option ${docData.floor === "3" ? "selected" : ""}>3</option>
          <option ${docData.floor === "4" ? "selected" : ""}>4</option>
        </select>
      </div>
      <div>
        <label style="font-weight:700;">ููุน ุงููุงุนุฉ</label>
        <select id="swal-type-edit" class="swal2-input" style="width:100%;">
          <option ${docData.type === "ูุตู ุฏุฑุงุณู" ? "selected" : ""}>ูุตู ุฏุฑุงุณู</option>
          <option ${docData.type === "ุบุฑูุฉ ุชุฏุฑูุจ" ? "selected" : ""}>ุบุฑูุฉ ุชุฏุฑูุจ</option>
          <option ${docData.type === "ุบุฑูุฉ ุฅุฌุชูุงุนุงุช" ? "selected" : ""}>ุบุฑูุฉ ุฅุฌุชูุงุนุงุช</option>
          <option ${docData.type === "ูุงุนุฉ ุนุฑุถ" ? "selected" : ""}>ูุงุนุฉ ุนุฑุถ</option>
          <option ${docData.type === "ูุฎุชุจุฑ ุงููุบุงุช" ? "selected" : ""}>ูุฎุชุจุฑ ุงููุบุงุช</option>
          <option ${docData.type === "ูุฎุชุจุฑ ุงูุญุงุณูุจ" ? "selected" : ""}>ูุฎุชุจุฑ ุงูุญุงุณูุจ</option>
          <option ${docData.type === "ุชุฏุฑูุจ ูุณุฑุญู" ? "selected" : ""}>ุชุฏุฑูุจ ูุณุฑุญู</option>
          <option ${docData.type === "ูุฎุชุจุฑ ุงูุชุตููุฑ ุงูุตุญูู" ? "selected" : ""}>ูุฎุชุจุฑ ุงูุชุตููุฑ ุงูุตุญูู</option>
          <option ${docData.type === "ูุฎุชุจุฑ ุงูุชุญุฑูุฑ" ? "selected" : ""}>ูุฎุชุจุฑ ุงูุชุญุฑูุฑ</option>
          <option ${docData.type === "ุฅูุชุงุฌ ุงูุตุญู" ? "selected" : ""}>ุฅูุชุงุฌ ุงูุตุญู</option>
          <option ${docData.type === "ูุฎุชุจุฑ ูุณุงุฆู ุงูุฅุนูุงู ุงูุฑูููุฉ" ? "selected" : ""}>ูุฎุชุจุฑ ูุณุงุฆู ุงูุฅุนูุงู ุงูุฑูููุฉ</option>
          <option ${docData.type === "ูุฎุชุจุฑ ุงูุฏุนุงูุฉ ูุงูุฅุนูุงู" ? "selected" : ""}>ูุฎุชุจุฑ ุงูุฏุนุงูุฉ ูุงูุฅุนูุงู</option>
          <option ${docData.type === "ูุฎุชุจุฑ ุงููุณุงุฆุท ุงููุชุนุฏุฏุฉ" ? "selected" : ""}>ูุฎุชุจุฑ ุงููุณุงุฆุท ุงููุชุนุฏุฏุฉ</option>
          <option ${docData.type === "ุงูุฅุฎุฑุงุฌ ุงูุฅุฐุงุนู" ? "selected" : ""}>ุงูุฅุฎุฑุงุฌ ุงูุฅุฐุงุนู</option>
          <option ${docData.type === "ุงููุณุฑุญ ุงูุฃุณูุฏ" ? "selected" : ""}>ุงููุณุฑุญ ุงูุฃุณูุฏ</option>
        </select>
      </div>
      <div>
        <label style="font-weight:700;">ุฑูู ุงููุงุนุฉ</label>
        <input id="swal-no-edit" class="swal2-input" value="${docData.no || ""}">
      </div>
      <div>
        <label style="font-weight:700;">ุงูุณุนุฉ</label>
        <input id="swal-cap-edit" class="swal2-input" value="${docData.cap || ""}">
      </div>
      <div>
        <label style="font-weight:700;">ุจูุฏููู</label>
        <select id="swal-podium-edit" class="swal2-input" style="width:100%;">
          <option ${docData.podium === "ุดุบุงู" ? "selected" : ""}>ุดุบุงู</option>
          <option ${docData.podium === "ููุฏ ุงูุตูุงูุฉ" ? "selected" : ""}>ููุฏ ุงูุตูุงูุฉ</option>
          <option ${docData.podium === "ุบูุฑ ุดุบุงู" ? "selected" : ""}>ุบูุฑ ุดุบุงู</option>
          <option ${docData.podium === "-" ? "selected" : ""}>-</option>
        </select>
      </div>
      <div>
        <label style="font-weight:700;">ุงูููุจููุชุฑ</label>
        <select id="swal-pc-edit" class="swal2-input" style="width:100%;">
          <option ${docData.pc === "ุดุบุงู" ? "selected" : ""}>ุดุบุงู</option>
          <option ${docData.pc === "ููุฏ ุงูุตูุงูุฉ" ? "selected" : ""}>ููุฏ ุงูุตูุงูุฉ</option>
          <option ${docData.pc === "ุบูุฑ ุดุบุงู" ? "selected" : ""}>ุบูุฑ ุดุบุงู</option>
          <option ${docData.pc === "-" ? "selected" : ""}>-</option>
        </select>
      </div>
      <div>
        <label style="font-weight:700;">ุงูุดุจูุฉ</label>
        <select id="swal-network-edit" class="swal2-input" style="width:100%;">
          <option ${docData.network === "ูุชุตู" ? "selected" : ""}>ูุชุตู</option>
          <option ${docData.network === "ุบูุฑ ูุชุตู" ? "selected" : ""}>ุบูุฑ ูุชุตู</option>
          <option ${docData.network === "-" ? "selected" : ""}>-</option>
        </select>
      </div>
      <div>
        <label style="font-weight:700;">ุฌูุงุฒ ุงูุนุฑุถ</label>
        <select id="swal-proj1-edit" class="swal2-input" style="width:100%;">
          <option ${docData.proj1 === "ุดุบุงู" ? "selected" : ""}>ุดุบุงู</option>
          <option ${docData.proj1 === "ููุฏ ุงูุตูุงูุฉ" ? "selected" : ""}>ููุฏ ุงูุตูุงูุฉ</option>
          <option ${docData.proj1 === "ุบูุฑ ุดุบุงู" ? "selected" : ""}>ุบูุฑ ุดุบุงู</option>
          <option ${docData.proj1 === "-" ? "selected" : ""}>-</option>
        </select>
      </div>
      <div>
        <label style="font-weight:700;">ุฌูุงุฒ ุงูุนุฑุถ</label>
        <select id="swal-proj2-edit" class="swal2-input" style="width:100%;">
          <option ${docData.proj2 === "ุดุบุงู" ? "selected" : ""}>ุดุบุงู</option>
          <option ${docData.proj2 === "ููุฏ ุงูุตูุงูุฉ" ? "selected" : ""}>ููุฏ ุงูุตูุงูุฉ</option>
          <option ${docData.proj2 === "ุบูุฑ ุดุบุงู" ? "selected" : ""}>ุบูุฑ ุดุบุงู</option>
          <option ${docData.proj2 === "-" ? "selected" : ""}>-</option>
        </select>
      </div>
      <div>
        <label style="font-weight:700;">ุงููููุฑูููู</label>
        <select id="swal-mic-edit" class="swal2-input" style="width:100%;">
          <option ${docData.mic === "ุดุบุงู" ? "selected" : ""}>ุดุบุงู</option>
          <option ${docData.mic === "ููุฏ ุงูุตูุงูุฉ" ? "selected" : ""}>ููุฏ ุงูุตูุงูุฉ</option>
          <option ${docData.mic === "ุบูุฑ ุดุบุงู" ? "selected" : ""}>ุบูุฑ ุดุบุงู</option>
          <option ${docData.mic === "-" ? "selected" : ""}>-</option>
        </select>
      </div>
      <div>
        <label style="font-weight:700;">ุงูุฅุถุงุกุฉ</label>
        <select id="swal-light-edit" class="swal2-input" style="width:100%;">
          <option ${docData.light === "ุดุบุงู" ? "selected" : ""}>ุดุบุงู</option>
          <option ${docData.light === "ููุฏ ุงูุตูุงูุฉ" ? "selected" : ""}>ููุฏ ุงูุตูุงูุฉ</option>
          <option ${docData.light === "ุบูุฑ ุดุบุงู" ? "selected" : ""}>ุบูุฑ ุดุบุงู</option>
          <option ${docData.light === "-" ? "selected" : ""}>-</option>
        </select>
      </div>
      <div>
        <label style="font-weight:700;">ุงูุณุชุงุฆุฑ</label>
        <select id="swal-curtain-edit" class="swal2-input" style="width:100%;">
          <option ${docData.curtain === "ุดุบุงู" ? "selected" : ""}>ุดุบุงู</option>
          <option ${docData.curtain === "ููุฏ ุงูุตูุงูุฉ" ? "selected" : ""}>ููุฏ ุงูุตูุงูุฉ</option>
          <option ${docData.curtain === "ุบูุฑ ุดุบุงู" ? "selected" : ""}>ุบูุฑ ุดุบุงู</option>
          <option ${docData.curtain === "-" ? "selected" : ""}>-</option>
        </select>
      </div>
      <div style="grid-column:1/3;">
        <label style="font-weight:700;">ููุงุญุธุงุช</label>
        <input id="swal-remark-edit" class="swal2-input" style="width:80%;" value="${docData.remark || ""}">
      </div>
    </div>
    `,
    preConfirm: () => {
      return {
        status: document.getElementById('swal-status-edit').value,
        building: document.getElementById('swal-building-edit').value,
        floor: document.getElementById('swal-floor-edit').value,
        type: document.getElementById('swal-type-edit').value,
        no: document.getElementById('swal-no-edit').value,
        cap: document.getElementById('swal-cap-edit').value,
        podium: document.getElementById('swal-podium-edit').value,
        pc: document.getElementById('swal-pc-edit').value,
        network: document.getElementById('swal-network-edit').value,
        proj1: document.getElementById('swal-proj1-edit').value,
        proj2: document.getElementById('swal-proj2-edit').value,
        mic: document.getElementById('swal-mic-edit').value,
        light: document.getElementById('swal-light-edit').value,
        curtain: document.getElementById('swal-curtain-edit').value,
        remark: document.getElementById('swal-remark-edit').value
      }
    }
  }).then(async (result) => {
    if (result.isConfirmed && result.value) {
      console.log("Document ID:", id, result.value);
      await db.collection(collectionName).doc(id).update({
        ...result.value,
        last_edited_by: currentUser || "ุบูุฑ ูุนุฑูู",
        last_edited_at: new Date().toISOString()
      })
      .then(() => {
        Swal.fire('โ ุชู ุงูุญูุธ ุจูุฌุงุญ', '', 'success');
      })
      .catch((e) => {
        Swal.fire('ุฎุทุฃ', e.message, 'error');
      });
    }
  });
}
  document.addEventListener("DOMContentLoaded", loadTable);

</script>
</body>
</html>
